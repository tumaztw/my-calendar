<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>張老師教學週報</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .today-card { border: 2px solid #3b82f6 !important; background-color: #eff6ff !important; }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="max-w-md mx-auto bg-white min-h-screen shadow-xl flex flex-col">
        <div class="bg-blue-600 p-6 text-white text-center">
            <h1 class="text-xl font-bold">張允蒼老師 教學看板</h1>
            <p class="text-xs opacity-80 mt-1">福山國中 114-1 | 楠梓 ⇄ 重信路</p>
        </div>

        <div class="flex items-center justify-between p-4 border-b bg-white sticky top-0 z-50">
            <button onclick="changeWeek(-1)" class="px-3 py-1 bg-gray-100 rounded-lg text-sm font-bold">◀ 上週</button>
            <div id="week-label" class="font-bold text-blue-800">載入中...</div>
            <button onclick="changeWeek(1)" class="px-3 py-1 bg-gray-100 rounded-lg text-sm font-bold">下週 ▶</button>
        </div>

        <div id="main-list" class="flex-1 p-4 space-y-4">
            <div class="text-center py-10 text-gray-400 italic">正在嘗試讀取課表與行事曆...</div>
        </div>

        <div class="p-4 text-[10px] text-center text-gray-300 border-t">
            若畫面空白，請嘗試重新整理網頁
        </div>
    </div>

    <script>
        // 1. 課表資料
        const schedule = {
            1: { 1: "國語 109", 2: "國語 117", 4: "國語 116" },
            2: { 2: "國語 116", 3: "國語 109", 5: "國語 117", 7: "閱讀 116" },
            3: { 2: "國語 109", 3: "國語 116", 7: "國語 117" },
            4: { 1: "國語 109", 3: "國語 117", 4: "國語 116", 6: "閱讀 109" },
            5: { 2: "國語 116", 5: "國語 117", 7: "國語 109" }
        };

        // 2. 行事曆活動
        const events = [
            { d: "2025-12-12", t: "校慶運動會", c: "bg-orange-500" },
            { d: "2025-12-15", t: "校慶補假", c: "bg-green-500" },
            { d: "2025-12-16", t: "班級開班會/畢冊截稿", c: "bg-gray-500" },
            { d: "2025-12-19", t: "校內語文競賽", c: "bg-blue-400" },
            { d: "2025-12-24", t: "國文作業抽查(習作/作文)", c: "bg-blue-600" },
            { d: "2026-01-01", t: "元旦放假", c: "bg-green-500" },
            { d: "2026-01-05", t: "服裝儀容檢查", c: "bg-purple-500" },
            { d: "2026-01-15", t: "第三次段考 Day1", c: "bg-red-500" },
            { d: "2026-01-16", t: "第三次段考 Day2", c: "bg-red-500" },
            { d: "2026-01-23", t: "休業式 (15:30放學)", c: "bg-blue-800" }
        ];

        let anchor = new Date();

        function render() {
            const list = document.getElementById('main-list');
            const label = document.getElementById('week-label');
            list.innerHTML = '';

            // 計算本週週一
            let curr = new Date(anchor);
            let day = curr.getDay();
            let diff = curr.getDate() - day + (day === 0 ? -6 : 1);
            let monday = new Date(curr.setDate(diff));

            label.innerText = (monday.getMonth()+1) + "/" + monday.getDate() + " - " + 
                              new Date(new Date(monday).setDate(monday.getDate()+6)).toLocaleDateString('zh-TW', {month:'numeric', day:'numeric'});

            for (let i = 0; i < 7; i++) {
                let d = new Date(monday);
                d.setDate(monday.getDate() + i);
                let dStr = d.getFullYear() + "-" + String(d.getMonth()+1).padStart(2,'0') + "-" + String(d.getDate()).padStart(2,'0');
                let isToday = new Date().toDateString() === d.toDateString();
                let weekday = d.getDay();

                // 找課程
                let classes = schedule[weekday] || {};
                let classHtml = Object.entries(classes).map(([p, n]) => 
                    `<div class="flex justify-between text-sm py-1 border-b border-gray-50 last:border-0">
                        <span class="text-blue-500 font-bold">第 ${p} 節</span>
                        <span class="text-gray-700">${n}</span>
                    </div>`
                ).join('');

                // 找活動
                let dayEvents = events.filter(e => e.d === dStr).map(e => 
                    `<div class="flex items-center gap-2 mb-1">
                        <span class="w-2 h-2 rounded-full ${
